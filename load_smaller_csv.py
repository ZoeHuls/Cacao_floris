import numpy as np
import pandas as pd

#df = pd.read_csv('C:\\Users\\zoe.huls\\OneDrive - Olam International\\MsC_Student_Zoe\\MsC_Student_Zoe\\4_Data\\2_Datasets\\cacao_survey_compressed.csv')
df = pd.read_csv('C:\\Users\\zoe.huls\\OneDrive - Olam International\\MsC_Student_Zoe\\MsC_Student_Zoe\\4_Data\\2_Datasets\\all_farmer_survey_compressed.csv')

dfg = df.groupby(by='country_name')

df_countries = pd.concat([dfg.get_group(name) for name in ["COTE D'IVOIRE",'GHANA', "NIGERIA","CAMEROON"]]) 

# questions = ["% as fungicide", '% as herbicides', '% as insecticides', 'Aim of remediation',
#              'Average cocoa tree age', 'Average kg of wood used by farmers (per tonne of dried cocoa beans) for cocoa farming-related field operations and post-harvest activities?',
#                'Did you separate spoiled beans (black, germinated, broken, flat, infected) from healthy beans before fermentation in the last crop cycle?', 'Do you have any of the following natural areas in your cocoa plots or their immediate surroundings?', 'Do you prune?','Does the farmer have a bank account?', 'Does the farmer have access to handwashing facilities with soap and water?', 'Does the farmer owns his farm?',
#                  'Farmer has access to clean water (only)', 'Farmer has access to clean water AND sanitation', 'For the main plot, take 5 measurements of the distance between trees, and record them in the boxes below. The application will calculate an average for you.', 'Has the farmer received any sort of loan or advance?', 'How did you dry your cocoa beans?',
#                    'How did you ferment the beans?', 'How many cocoa plots do you have? (include rented plots and sharecropping)', 'How many cocoa seedlings did you plant in new cocoa farm areas? (provided by ofi or other sources)', 'How many cocoa seedlings did you plant on all your existing cocoa plots during the last crop cycle? (provided by ofi or other sources)', 
#                    'How many cocoa trees have you rejuvenated (through grafting or chupon grow) in all your cocoa plots during the last crop cycle?', 'How many different chemical fertilisers did you apply on all cocoa plots during the last crop cycle?', 'How many different fungicides did you apply on all cocoa plots during the last crop cycle?', 'How many different insecticides did you apply on all cocoa plots during the last crop cycle?',
#                      'How many different non-cocoa tree species did you plant (i.e. seedlings) in all your cocoa plots during the last crop cycle?', 'How many different organic fertilisers did you apply to all cocoa plots during the last crop cycle?', 'How many different species of non-cocoa trees do you have in all your cocoa plots? (older than 2 years)','How many full days did these hired labourers work in total on all cocoa plots during the last crop cycle?',
#                        'How many hired (paid) labourers were migrant workers? (migrant: from other region of the country or another country coming especially to work on the farm)', 'How many of each (trees, plants, animals or beehives)?', 'How many permanent hired labourers did you employ on all cocoa plots during the last crop cycle?  (hired laborer: paid for their services in money or goods)', 'How many seedlings of each non-cocoa tree species?', 'How many shade trees do you have in your cocoa plots?', 'How many shade trees/ha do you have in your cocoa plots?',
#                          'How many temporary hired labourers did you employ on all cocoa plots during the last crop cycle?  (temporary workers: working only for specific activities and time during the year, including seasonal workers)', 'How many times did you mix the beans during fermentation in the last crop cycle (on average)?', 'How many trees of each species? (older than 2 years)', 'How many types of crops and livestock, other than cocoa, did you produce on all cocoa and non-cocoa farmland during the last crop cycle?', 'How often did you harvest pods during the last crop cycle (on average)?',
#                            'How often does the farmer visit his farm?', 'How were these paid labourers hired?', 'If yes, which banking systems do you actively use?', 'If you used credit during the last full crop cycle, where did you obtain it?', 'Is the household food secure?', 'Level of weeding', 'Name of crop/livestock', 'Name of fungicide', 'Name of insecticide', 'Name of the chemical fertilizer applied? (commercial name)', 'Name of the organic fertilizer applied? (commercial name)', 'Non-cocoa seedlings planted per hectare', 'Number of days per week?', 'Number of hectares rehabilitated (ha)', 'ONLY FOR BRAZIL - What percentage of the cocoa production is managed by sharecroppers?', 'ONLY FOR CDI, BRAZIL, NIGERIA, CAMEROON, GHANA, ECUADOR, INDONESIA, PNG - How many sharecroppers do you have in your cocoa farm?', 'ONLY FOR ECUADOR, BRAZIL - What is the average amount of irrigation water applied in all your cocoa plots (m3/ha)?', 'ONLY FOR ECUADOR, INDONESIA, BRAZIL - What is the average amount of irrigation water applied in all your cocoa plots (m3/ha)?','ONLY FOR ECUADOR, INDONESIA, BRAZIL- What types of irrigation systems did you use in your cocoa plots in the last crop cycle?', 'ONLY FOR GHANA - Is there a caretaker on your cocoa farm? (a caretaker is a person, apart from the farmerâ€™s spouse or child, that receives part of the cocoa production in return for managing the farm and that does not become an owner at the end of the agreement period)', 'ONLY FOR NIGERIA, CAMEROON, BRAZIL - What percentage of the total value of non-cocoa crop production on average can the sharecropper(s) keep?', 'Pesticides per hectare (liters) includes (fungicides, insecticides, herbicides)', 'Please ask the farmer to read aloud the following passage: John is a small boy. He lives in a village with his brothers and sisters. He goes to school every week.  Could the farmer read it?', 'Please take the location', 'Previous schooling situation', 'Relationship with farmer/worker', 'Remediation action received (multiple answers possible)', 'School attendance', 'Seedlings planted per ha', 'Total amount (kg) applied to all cocoa plots', 'Total amount of chemical fertilizer (kg) applied to all cocoa plots', 'Total amount of chemical fertilizer applied per hectare (kg/ha)', 'Total amount of fertilizer applied to all cocoa plots (kg)', 'Total amount of insecticides', 'Total amount of organic fertilizer applied per hectare (kg/ha)', 'Total amount of organic fertilizer per hectare (kg)  applied to all cocoa plots', 'Total amount of pesticides applied on farm (liters)', 'Total fertilizer applied per hectare (kg/ha)', 'Total hired labour days', 'Total pesticides applied as active ingredients (a.i.)  kg/ha', 'Updated cocoa tree density (trees/ha)','What did you do with infected/diseased pods in the last crop cycle?', 'What did you do with open cocoa pods husks, branch residues, leaves and fallen cocoa trees and other post-harvest losses? (within a month of pod harvesting, prunning, tree remova, or fallen tree event)', 'What is the age of your oldest cocoa plot?',
#                              'What is the farm ownership status of your cocoa farmland? (Please respond about your main plot: plot producing the largest cocoa quantity)', 'What is the main type of contract that you had with your labourers? (for the majority of hired/paid workers)', 'What is the total amount of chemical herbicide applied to all your cocoa plots in the last crop cycle? If liquid, please answer the number of non-diluted liters of herbicide used.', 'What is the total amount of fungicides applied to all your cocoa plots in the last crop cycle? (report in grams if non-liquid, and non-diluted liters if liquid)', 'What is the total amount of insecticide applied to all your cocoa plots in the last crop cycle?  (report in grams if non-liquid, and non-diluted liters if liquid)', 'What is the total kg of wood used for cocoa farming-related field operations and post-harvest activities?', 'What of the following soil ammendments you applied to your cocoa plots during the last crop cycle?', 'What percentage of your cocoa trees are aged 0 to 5 years?', 'What percentage of your cocoa trees are aged 20-25 years?', 'What percentage of your cocoa trees are aged 5-20 years?', 'What percentage of your cocoa trees are over 25 years?', "What percentage of your household's total farm income came from additional cocoa or non-cocoa farms not yet reported in this survey? (Include farms not selling to ofi)", "What percentage of your household's total income came from off-farm income (e.g. small shop, wage labour, land rental, pensions, welfare payments)?", 'What pests and diseases were present in your cocoa plots in the last crop cycle?', 'What pruning practices have you implemented on all of your cocoa plots in the last crop season? ENUMERATOR: Refer to guideline for the exact definition of each level.', 'What soil fertility practices can you see on the farm?', 'What species?', 'What was the disease contamination level in your cocoa plots in the last crop cycle? (disease causing most damage to production): Please refer to guideline for the exact definition of each level.', 'What was the farmer highest educational level attained?', 'What was the level of pruning on all of your cocoa plots in the last crop season?  ENUMERATOR: Refer to guideline for the exact definition of each level.', 'What was the level of weeding on all of your cocoa plots in the last crop cycle?  ENUMERATOR: Refer to guideline for the exact definition of each level.', 'What was the most damaging disease in your cocoa plots in the last crop cycle?', 'What was the most damaging pest in your cocoa plots in the last crop cycle?', 'What was the pest infestation level in your cocoa plots in the last crop cycle? (pest causing most damage to production): Please refer to guideline for the exact definition of each level.', 'Which chemical herbicides did you use in the last crop cycle?', 'Which of the following soil monitoring actions you used in your cocoa plots in the last crop cycle?', 'Which of these sanitary post-harvesting practices can you see on the farm?', 'Which soil erosion control practices did you apply on your cocoa plots in the last crop cycle?', 'Which weeding techniques did you use in the last crop cycle?']
# dfg_countries = df_countries.groupby(by='question')
# dfg_countries_smaller = pd.concat([dfg_countries.get_group(name) for name in questions]) 
df_countries.to_csv('C:\\Users\\zoe.huls\\OneDrive - Olam International\\MsC_Student_Zoe\\MsC_Student_Zoe\\4_Data\\2_Datasets\\countries_questions_yield_compressed.csv', index=False)